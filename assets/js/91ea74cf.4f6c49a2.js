"use strict";(self.webpackChunkxuecodex=self.webpackChunkxuecodex||[]).push([[3465],{2779:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>d,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"topics/ai-fundamentals/dataloader","title":"What Is a DataLoader in PyTorch","description":"\ud83e\udde0 What Is a DataLoader in PyTorch (and Why It Matters)?","source":"@site/docs/topics/ai-fundamentals/dataloader.md","sourceDirName":"topics/ai-fundamentals","slug":"/topics/ai-fundamentals/dataloader","permalink":"/docs/topics/ai-fundamentals/dataloader","draft":false,"unlisted":false,"editUrl":"https://github.com/vlakmaker/XueCodex/tree/main/docs/topics/ai-fundamentals/dataloader.md","tags":[{"inline":true,"label":"ai-fundamentals","permalink":"/docs/tags/ai-fundamentals"},{"inline":true,"label":"definition","permalink":"/docs/tags/definition"},{"inline":true,"label":"dataloader","permalink":"/docs/tags/dataloader"}],"version":"current","frontMatter":{"id":"dataloader","title":"What Is a DataLoader in PyTorch","tags":["ai-fundamentals","definition","dataloader"]},"sidebar":"tutorialSidebar","previous":{"title":"What Is Data? (Types, Formats & Terminology)","permalink":"/docs/topics/ai-fundamentals/data"},"next":{"title":"Overview of Key Generative AI Models","permalink":"/docs/topics/ai-fundamentals/gen-ai-models"}}');var s=t(4848),i=t(8453);const d={id:"dataloader",title:"What Is a DataLoader in PyTorch",tags:["ai-fundamentals","definition","dataloader"]},r=void 0,l={},o=[{value:"\ud83e\udde0 What Is a DataLoader in PyTorch (and Why It Matters)?",id:"-what-is-a-dataloader-in-pytorch-and-why-it-matters",level:2},{value:"\ud83e\uddf0 Key Concepts",id:"-key-concepts",level:3},{value:"1. <strong>Dataset</strong>",id:"1-dataset",level:3},{value:"2. <strong>DataLoader</strong>",id:"2-dataloader",level:3},{value:"\ud83c\udfd7\ufe0f How It Works (Example Setup)",id:"\ufe0f-how-it-works-example-setup",level:3},{value:"Step 1: Create a Custom Dataset Class",id:"step-1-create-a-custom-dataset-class",level:3},{value:"Step 2: Load Data Using DataLoader",id:"step-2-load-data-using-dataloader",level:3},{value:"\ud83e\uddea Tokenization, Numericalization &amp; Padding",id:"-tokenization-numericalization--padding",level:3},{value:"\ud83e\udde9 Custom Collate Function",id:"-custom-collate-function",level:3},{value:"\ud83d\udd01 Recap",id:"-recap",level:2}];function c(e){const n={code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"-what-is-a-dataloader-in-pytorch-and-why-it-matters",children:"\ud83e\udde0 What Is a DataLoader in PyTorch (and Why It Matters)?"}),"\n",(0,s.jsx)(n.p,{children:"Imagine you\u2019re training an AI model on tons of text \u2014 you can\u2019t load everything into memory at once, right?"}),"\n",(0,s.jsxs)(n.p,{children:["You need to feed your model the data in ",(0,s.jsx)(n.strong,{children:"small batches"}),", ",(0,s.jsx)(n.strong,{children:"shuffle it"}),", and ",(0,s.jsx)(n.strong,{children:"preprocess it efficiently"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["That\u2019s exactly what a ",(0,s.jsx)(n.strong,{children:"DataLoader"})," helps you do."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"-key-concepts",children:"\ud83e\uddf0 Key Concepts"}),"\n",(0,s.jsxs)(n.h3,{id:"1-dataset",children:["1. ",(0,s.jsx)(n.strong,{children:"Dataset"})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Think of this as a big list of samples (e.g., text sentences and their labels)."}),"\n",(0,s.jsxs)(n.li,{children:["You split it into:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Training set"})," (to teach the model)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Validation set"})," (to tune and check it)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Test set"})," (to evaluate final performance)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"2-dataloader",children:["2. ",(0,s.jsx)(n.strong,{children:"DataLoader"})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["A PyTorch tool that:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Loads data in ",(0,s.jsx)(n.strong,{children:"batches"})," (faster training)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Shuffles"})," data (helps generalization)"]}),"\n",(0,s.jsxs)(n.li,{children:["Can do ",(0,s.jsx)(n.strong,{children:"on-the-fly preprocessing"})," like tokenizing and padding"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"\ufe0f-how-it-works-example-setup",children:"\ud83c\udfd7\ufe0f How It Works (Example Setup)"}),"\n",(0,s.jsx)(n.h3,{id:"step-1-create-a-custom-dataset-class",children:"Step 1: Create a Custom Dataset Class"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"python\nCopyEdit\nclass CustomDataset(Dataset):\n    def __init__(self, sentences):\n        self.sentences = sentences\n\n    def __len__(self):\n        return len(self.sentences)\n\n    def __getitem__(self, idx):\n        return self.sentences[idx]\n\n"})}),"\n",(0,s.jsx)(n.p,{children:"This class wraps a list of sentences and lets you access items by index \u2014 just like a list."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"step-2-load-data-using-dataloader",children:"Step 2: Load Data Using DataLoader"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"python\nCopyEdit\ndata_loader = DataLoader(dataset, batch_size=2, shuffle=True)\n\n"})}),"\n",(0,s.jsx)(n.p,{children:"Now instead of returning one sentence at a time, you get batches of two."}),"\n",(0,s.jsxs)(n.p,{children:["Each time you call ",(0,s.jsx)(n.code,{children:"next()"}),", you get the ",(0,s.jsx)(n.strong,{children:"next batch"})," \u2014 great for training loops."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"-tokenization-numericalization--padding",children:"\ud83e\uddea Tokenization, Numericalization & Padding"}),"\n",(0,s.jsxs)(n.p,{children:["Most NLP models can\u2019t read text \u2014 they need ",(0,s.jsx)(n.strong,{children:"numbers"}),". So you do the following:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Tokenize"})," \u2013 split text into tokens (words or subwords)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Build a Vocabulary"})," \u2013 give each token a unique ID"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Numericalize"})," \u2013 turn each sentence into a list of numbers"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Pad"})," \u2013 ensure every sentence in a batch is the same length"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Example using PyTorch:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'python\nCopyEdit\ntokenizer = get_tokenizer("basic_english")\nvocab = build_vocab_from_iterator([...])\npadded = pad_sequence([...], batch_first=True, padding_value=0)\n\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"-custom-collate-function",children:"\ud83e\udde9 Custom Collate Function"}),"\n",(0,s.jsxs)(n.p,{children:["When you want all these transformations to happen ",(0,s.jsx)(n.em,{children:"while loading the batch"}),", you can use a ",(0,s.jsx)(n.strong,{children:"collate function"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"python\nCopyEdit\ndef collate_fn(batch):\n    tokenized = [tokenizer(x) for x in batch]\n    numericalized = [torch.tensor([vocab[token] for token in tokens]) for tokens in tokenized]\n    padded = pad_sequence(numericalized, batch_first=True, padding_value=0)\n    return padded\n\n"})}),"\n",(0,s.jsx)(n.p,{children:"Then use it in your DataLoader:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"python\nCopyEdit\nDataLoader(dataset, batch_size=2, shuffle=True, collate_fn=collate_fn)\n\n"})}),"\n",(0,s.jsx)(n.p,{children:"Now every batch comes preprocessed, padded, and ready for the model."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-recap",children:"\ud83d\udd01 Recap"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Concept"}),(0,s.jsx)(n.th,{children:"Purpose"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Dataset"})}),(0,s.jsx)(n.td,{children:"Holds raw samples (e.g., sentences)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"DataLoader"})}),(0,s.jsx)(n.td,{children:"Loads and batches them efficiently"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Collate Function"})}),(0,s.jsx)(n.td,{children:"Tokenizes, numericalizes, and pads samples in each batch"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Batch First"})}),(0,s.jsxs)(n.td,{children:["Ensures batch is the first tensor dimension (",(0,s.jsx)(n.code,{children:"[batch, seq_len]"}),")"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Padding"})}),(0,s.jsx)(n.td,{children:"Makes all sequences the same length for matrix input"})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>d,x:()=>r});var a=t(6540);const s={},i=a.createContext(s);function d(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);