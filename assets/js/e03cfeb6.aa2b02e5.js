"use strict";(self.webpackChunkxuecodex=self.webpackChunkxuecodex||[]).push([[593],{6455:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"topics/deep-learning/document-categorization-prediction","title":"Converting Words to Features in NLP","description":"---","source":"@site/docs/topics/deep-learning/document-categorization-prediction.md","sourceDirName":"topics/deep-learning","slug":"/topics/deep-learning/document-categorization-prediction","permalink":"/docs/topics/deep-learning/document-categorization-prediction","draft":false,"unlisted":false,"editUrl":"https://github.com/vlakmaker/XueCodex/tree/main/docs/topics/deep-learning/document-categorization-prediction.md","tags":[{"inline":true,"label":"deep learning","permalink":"/docs/tags/deep-learning"},{"inline":true,"label":"neural networks","permalink":"/docs/tags/neural-networks"},{"inline":true,"label":"words","permalink":"/docs/tags/words"}],"version":"current","frontMatter":{"id":"document-categorization-prediction","title":"Converting Words to Features in NLP","tags":["deep learning","neural networks","words"]},"sidebar":"tutorialSidebar","previous":{"title":"Converting Words to Features in NLP","permalink":"/docs/topics/deep-learning/convert-words-features"},"next":{"title":"The Drivetrain Approach: A Strategic Framework for AI Development","permalink":"/docs/topics/deep-learning/drivetrain-approach"}}');var t=r(4848),i=r(8453);const l={id:"document-categorization-prediction",title:"Converting Words to Features in NLP",tags:["deep learning","neural networks","words"]},o="\u201cDocument Categorization Prediction with TorchText\u201d",d={},c=[{value:"\ud83e\udde0 1. <strong>Document Classifier Overview</strong>",id:"-1-document-classifier-overview",level:3},{value:"\ud83d\udd22 2. <strong>Neural Network Basics</strong>",id:"-2-neural-network-basics",level:3},{value:"\ud83d\udd39 Layers in a Neural Network:",id:"-layers-in-a-neural-network",level:3},{value:"\ud83d\udd39 Logits:",id:"-logits",level:3},{value:"\ud83d\udd39 Argmax Function:",id:"-argmax-function",level:3},{value:"\u2699\ufe0f 3. <strong>Hyperparameters</strong>",id:"\ufe0f-3-hyperparameters",level:3},{value:"\ud83e\uddf0 4. <strong>PyTorch Implementation Overview</strong>",id:"-4-pytorch-implementation-overview",level:3},{value:"\ud83d\udd39 Dataset: <strong>AG News Dataset</strong>",id:"-dataset-ag-news-dataset",level:3},{value:"\ud83d\udd39 Processing Pipeline:",id:"-processing-pipeline",level:3},{value:"\ud83e\uddf1 5. <strong>Model Architecture</strong>",id:"-5-model-architecture",level:3},{value:"\ud83d\udd38 1. <strong>Embedding Bag Layer</strong>",id:"-1-embedding-bag-layer",level:3},{value:"\ud83d\udd38 2. <strong>Fully Connected (Linear) Layer</strong>",id:"-2-fully-connected-linear-layer",level:3},{value:"\ud83e\uddea 6. <strong>Prediction Workflow</strong>",id:"-6-prediction-workflow",level:3},{value:"\ud83d\udd04 7. <strong>Batching</strong>",id:"-7-batching",level:3},{value:"\u2705 Recap Summary",id:"-recap-summary",level:2}];function a(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"document-categorization-prediction-with-torchtext",children:(0,t.jsx)(n.strong,{children:"\u201cDocument Categorization Prediction with TorchText\u201d"})})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h3,{id:"-1-document-classifier-overview",children:["\ud83e\udde0 1. ",(0,t.jsx)(n.strong,{children:"Document Classifier Overview"})]}),"\n",(0,t.jsxs)(n.p,{children:["A ",(0,t.jsx)(n.strong,{children:"document classifier"})," is a model that takes raw text (like news articles) and predicts which category it belongs to \u2014 e.g., ",(0,t.jsx)(n.em,{children:"sports"}),", ",(0,t.jsx)(n.em,{children:"business"}),", or ",(0,t.jsx)(n.em,{children:"science"}),"."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Input:"})," Raw text"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Output:"})," A predicted class label (e.g., \u201csports\u201d)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"How:"})," Converts text \u2192 numbers \u2192 applies neural network \u2192 outputs classification"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h3,{id:"-2-neural-network-basics",children:["\ud83d\udd22 2. ",(0,t.jsx)(n.strong,{children:"Neural Network Basics"})]}),"\n",(0,t.jsxs)(n.p,{children:["A ",(0,t.jsx)(n.strong,{children:"neural network"})," is a function made up of layers of connected \u201cneurons\u201d (really just numbers and matrix operations). Here\u2019s how the flow works:"]}),"\n",(0,t.jsx)(n.h3,{id:"-layers-in-a-neural-network",children:"\ud83d\udd39 Layers in a Neural Network:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Input Layer:"})}),"\n",(0,t.jsx)(n.p,{children:"Accepts a numeric representation of the text (e.g., bag-of-words or embeddings)."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Hidden Layers:"})}),"\n",(0,t.jsx)(n.p,{children:"Perform matrix multiplication and apply activation functions like ReLU or sigmoid. These layers \u201clearn\u201d internal features."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Output Layer:"})}),"\n",(0,t.jsxs)(n.p,{children:["Produces a vector of ",(0,t.jsx)(n.strong,{children:"logits"})," \u2014 one number per possible class."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"-logits",children:"\ud83d\udd39 Logits:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Raw, unnormalized scores (can be negative or positive)."}),"\n",(0,t.jsx)(n.li,{children:"Not probabilities \u2014 just signals for classification."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"-argmax-function",children:"\ud83d\udd39 Argmax Function:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Applied to the output logits."}),"\n",(0,t.jsxs)(n.li,{children:["Returns the ",(0,t.jsx)(n.strong,{children:"index"})," of the largest value \u2014 this corresponds to the predicted class."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h3,{id:"\ufe0f-3-hyperparameters",children:["\u2699\ufe0f 3. ",(0,t.jsx)(n.strong,{children:"Hyperparameters"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Hyperparameters"})," are configurations ",(0,t.jsx)(n.strong,{children:"you set manually"})," when designing a neural network. Common ones include:"]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Hyperparameter"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Number of hidden layers"})}),(0,t.jsx)(n.td,{children:"Depth of the network"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Neurons per layer"})}),(0,t.jsx)(n.td,{children:"Width or complexity per layer"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Embedding dimension"})}),(0,t.jsx)(n.td,{children:"Size of the dense word vector"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Number of output classes"})}),(0,t.jsx)(n.td,{children:"Equals the number of possible categories (e.g., 4 for news: world, sports, business, tech)"})]})]})]}),"\n",(0,t.jsxs)(n.p,{children:["These are ",(0,t.jsx)(n.strong,{children:"not"})," learned \u2014 you tune them using validation data."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h3,{id:"-4-pytorch-implementation-overview",children:["\ud83e\uddf0 4. ",(0,t.jsx)(n.strong,{children:"PyTorch Implementation Overview"})]}),"\n",(0,t.jsxs)(n.h3,{id:"-dataset-ag-news-dataset",children:["\ud83d\udd39 Dataset: ",(0,t.jsx)(n.strong,{children:"AG News Dataset"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Each row = (label, text)"}),"\n",(0,t.jsxs)(n.li,{children:["Labels are mapped to categories like:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"0 = World"}),"\n",(0,t.jsx)(n.li,{children:"1 = Sports"}),"\n",(0,t.jsx)(n.li,{children:"2 = Business"}),"\n",(0,t.jsx)(n.li,{children:"3 = Science & Tech"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"-processing-pipeline",children:"\ud83d\udd39 Processing Pipeline:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Tokenization"})," \u2192 Convert raw text into tokens (e.g., \u201cI like cats\u201d \u2192 \u201cI\u201d,\u201clike\u201d,\u201ccats\u201d\u201cI\u201d, \u201clike\u201d, \u201ccats\u201d\u201cI\u201d,\u201clike\u201d,\u201ccats\u201d)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Vocabulary"})," \u2192 Each token gets an index."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Indexing"})," \u2192 Tokens in text are replaced with their corresponding index."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Offsets"})," \u2192 Track where each document starts in a flattened tensor."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h3,{id:"-5-model-architecture",children:["\ud83e\uddf1 5. ",(0,t.jsx)(n.strong,{children:"Model Architecture"})]}),"\n",(0,t.jsxs)(n.h3,{id:"-1-embedding-bag-layer",children:["\ud83d\udd38 1. ",(0,t.jsx)(n.strong,{children:"Embedding Bag Layer"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Similar to ",(0,t.jsx)(n.code,{children:"nn.Embedding"})," but directly aggregates multiple tokens into one vector (by summing or averaging)."]}),"\n",(0,t.jsx)(n.li,{children:"Input: token indices and offsets"}),"\n",(0,t.jsx)(n.li,{children:"Output: single vector for the document"}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"-2-fully-connected-linear-layer",children:["\ud83d\udd38 2. ",(0,t.jsx)(n.strong,{children:"Fully Connected (Linear) Layer"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Maps the aggregated vector to output logits (one per category)."}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"python\nCopyEdit\nclass TextClassificationModel(nn.Module):\n    def __init__(self, vocab_size, embed_dim, num_class):\n        super().__init__()\n        self.embedding = nn.EmbeddingBag(vocab_size, embed_dim, sparse=True)\n        self.fc = nn.Linear(embed_dim, num_class)\n\n    def forward(self, text, offsets):\n        embedded = self.embedding(text, offsets)\n        return self.fc(embedded)\n\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h3,{id:"-6-prediction-workflow",children:["\ud83e\uddea 6. ",(0,t.jsx)(n.strong,{children:"Prediction Workflow"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Input: Tokenized and indexed text + offset"}),"\n",(0,t.jsx)(n.li,{children:"Pass through embedding bag \u2192 get dense representation"}),"\n",(0,t.jsx)(n.li,{children:"Pass through fully connected layer \u2192 get logits"}),"\n",(0,t.jsxs)(n.li,{children:["Apply ",(0,t.jsx)(n.strong,{children:"argmax"})," \u2192 get predicted class"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"python\nCopyEdit\noutput = model(text_tensor, offset_tensor)\nprediction = torch.argmax(output, dim=1)\n\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h3,{id:"-7-batching",children:["\ud83d\udd04 7. ",(0,t.jsx)(n.strong,{children:"Batching"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Batching is used to process multiple documents at once."}),"\n",(0,t.jsxs)(n.li,{children:["Use PyTorch\u2019s ",(0,t.jsx)(n.code,{children:"DataLoader"})," to batch inputs."]}),"\n",(0,t.jsxs)(n.li,{children:["Create a ",(0,t.jsx)(n.strong,{children:"batch function"})," that:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Flattens text indices from all samples into one tensor."}),"\n",(0,t.jsx)(n.li,{children:"Adds an offset to mark where each sample starts."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"-recap-summary",children:"\u2705 Recap Summary"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Concept"}),(0,t.jsx)(n.th,{children:"Explanation"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Neural Network"})}),(0,t.jsx)(n.td,{children:"Transforms numeric input into a classification through layers of weights and activations"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Embedding Bag"})}),(0,t.jsx)(n.td,{children:"Maps word indices to dense vectors and aggregates them for full documents"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Logits"})}),(0,t.jsx)(n.td,{children:"Raw output scores (one per class), used before applying argmax"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Argmax"})}),(0,t.jsx)(n.td,{children:"Selects the index of the highest logit to predict the document\u2019s class"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Hyperparameters"})}),(0,t.jsx)(n.td,{children:"Settings like number of layers, neurons, and embedding size, manually tuned"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Text Pipeline"})}),(0,t.jsx)(n.td,{children:"Tokenization \u2192 Indexing \u2192 Offsets \u2192 Embedding \u2192 Classification"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Batching"})}),(0,t.jsxs)(n.td,{children:["Combines multiple samples for efficient processing with ",(0,t.jsx)(n.code,{children:"offsets"})," to track each"]})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>o});var s=r(6540);const t={},i=s.createContext(t);function l(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);